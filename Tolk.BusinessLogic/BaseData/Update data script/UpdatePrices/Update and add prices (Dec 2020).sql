

BEGIN TRAN

SELECT * FROM PriceListRows

UPDATE PriceListRows
SET EndDate = '20201231'
WHERE EndDate = '99991231'

SET IDENTITY_INSERT PriceListRows ON
INSERT PriceListRows (PriceListRowId, PriceListType, StartDate, EndDate, MaxMinutes, Price, CompetenceLevel, PriceListRowType)

	VALUES 
	
	------------------- Taxa 1 Court ---------------------
	
	--0-1h, 372, 433, 509, 642
	(385, 1, '20210101', '99991231', 60, 372, 1, 1),
	(386, 1, '20210101', '99991231', 60, 433, 2, 1),
	(387, 1, '20210101', '99991231', 60, 509, 3, 1),
	(388, 1, '20210101', '99991231', 60, 642, 4, 1),

	--1-1,5h 506, 601. 704, 895
	(389, 1, '20210101', '99991231', 90, 506, 1, 1),
	(390, 1, '20210101', '99991231', 90, 601, 2, 1),
	(391, 1, '20210101', '99991231', 90, 704, 3, 1),
	(392, 1, '20210101', '99991231', 90, 895, 4, 1),

	--1,5-2h 640, 769, 899, 1148
	(393, 1, '20210101', '99991231', 120, 640, 1, 1),
	(394, 1, '20210101', '99991231', 120, 769, 2, 1),
	(395, 1, '20210101', '99991231', 120, 899, 3, 1),
	(396, 1, '20210101', '99991231', 120, 1148, 4, 1),

	--2-2,5h, 774, 937, 1094, 1401
	(397, 1, '20210101', '99991231', 150, 774, 1, 1),
	(398, 1, '20210101', '99991231', 150, 937, 2, 1),
	(399, 1, '20210101', '99991231', 150, 1094, 3, 1),
	(400, 1, '20210101', '99991231', 150, 1401, 4, 1),

	--2,5-3h, 908, 1105, 1289, 1654
	(401, 1, '20210101', '99991231', 180, 908, 1, 1),
	(402, 1, '20210101', '99991231', 180, 1105, 2, 1),
	(403, 1, '20210101', '99991231', 180, 1289, 3, 1),
	(404, 1, '20210101', '99991231', 180, 1654, 4, 1),

	--3-3,5h, 1042, 1273, 1484, 1907
	(405, 1, '20210101', '99991231', 210, 1042, 1, 1),
	(406, 1, '20210101', '99991231', 210, 1273, 2, 1),
	(407, 1, '20210101', '99991231', 210, 1484, 3, 1),
	(408, 1, '20210101', '99991231', 210, 1907, 4, 1),

	--3,5-4h, 1176, 1441, 1679, 2160
	(409, 1, '20210101', '99991231', 240, 1176, 1, 1),
	(410, 1, '20210101', '99991231', 240, 1441, 2, 1),
	(411, 1, '20210101', '99991231', 240, 1679, 3, 1),
	(412, 1, '20210101', '99991231', 240, 2160, 4, 1),

	--4-4,5h, 1310, 1609, 1874, 2413
	(413, 1, '20210101', '99991231', 270, 1310, 1, 1),
	(414, 1, '20210101', '99991231', 270, 1609, 2, 1),
	(415, 1, '20210101', '99991231', 270, 1874, 3, 1),
	(416, 1, '20210101', '99991231', 270, 2413, 4, 1),

	--4,5-5h, 1444, 1777, 2069, 2666
	(417, 1, '20210101', '99991231', 300, 1444, 1, 1),
	(418, 1, '20210101', '99991231', 300, 1777, 2, 1),
	(419, 1, '20210101', '99991231', 300, 2069, 3, 1),
	(420, 1, '20210101', '99991231', 300, 2666, 4, 1),

	--5-5,5h, 1578, 1945, 2264, 2919
	(421, 1, '20210101', '99991231', 330, 1578, 1, 1),
	(422, 1, '20210101', '99991231', 330, 1945, 2, 1),
	(423, 1, '20210101', '99991231', 330, 2264, 3, 1),
	(424, 1, '20210101', '99991231', 330, 2919, 4, 1),
	
	
	------------------- Taxa 2 Others ---------------------
	
	--0-1h, 310, 360, 423, 541
	(425, 2, '20210101', '99991231', 60, 310, 1, 1),
	(426, 2, '20210101', '99991231', 60, 360, 2, 1),
	(427, 2, '20210101', '99991231', 60, 423, 3, 1),
	(428, 2, '20210101', '99991231', 60, 541, 4, 1),

	--1-1,5h, 444, 522, 611, 781
	(429, 2, '20210101', '99991231', 90, 444, 1, 1),
	(430, 2, '20210101', '99991231', 90, 522, 2, 1),
	(431, 2, '20210101', '99991231', 90, 611, 3, 1),
	(432, 2, '20210101', '99991231', 90, 781, 4, 1),

	--1,5-2h, 578, 684, 799, 1021
	(433, 2, '20210101', '99991231', 120, 578, 1, 1),
	(434, 2, '20210101', '99991231', 120, 684, 2, 1),
	(435, 2, '20210101', '99991231', 120, 799, 3, 1),
	(436, 2, '20210101', '99991231', 120, 1021, 4, 1),

	--2-2,5h, 712, 846, 987, 1261
	(437, 2, '20210101', '99991231', 150, 712, 1, 1),
	(438, 2, '20210101', '99991231', 150, 846, 2, 1),
	(439, 2, '20210101', '99991231', 150, 987, 3, 1),
	(440, 2, '20210101', '99991231', 150, 1261, 4, 1),

	--2,5-3h, 846, 1008, 1175, 1501
	(441, 2, '20210101', '99991231', 180, 846, 1, 1),
	(442, 2, '20210101', '99991231', 180, 1008, 2, 1),
	(443, 2, '20210101', '99991231', 180, 1175, 3, 1),
	(444, 2, '20210101', '99991231', 180, 1501, 4, 1),

	--3-3,5h, 980, 1170, 1363, 1741
	(445, 2, '20210101', '99991231', 210, 980, 1, 1),
	(446, 2, '20210101', '99991231', 210, 1170, 2, 1),
	(447, 2, '20210101', '99991231', 210, 1363, 3, 1),
	(448, 2, '20210101', '99991231', 210, 1741, 4, 1),

	--3,5-4h, 1114, 1332, 1551, 1981
	(449, 2, '20210101', '99991231', 240, 1114, 1, 1),
	(450, 2, '20210101', '99991231', 240, 1332, 2, 1),
	(451, 2, '20210101', '99991231', 240, 1551, 3, 1),
	(452, 2, '20210101', '99991231', 240, 1981, 4, 1),

	--4-4,5h, 1248, 1494, 1739, 2221
	(453, 2, '20210101', '99991231', 270, 1248, 1, 1),
	(454, 2, '20210101', '99991231', 270, 1494, 2, 1),
	(455, 2, '20210101', '99991231', 270, 1739, 3, 1),
	(456, 2, '20210101', '99991231', 270, 2221, 4, 1),

	--4,5-5h, 1382, 1656, 1927, 2461
	(457, 2, '20210101', '99991231', 300, 1382, 1, 1),
	(458, 2, '20210101', '99991231', 300, 1656, 2, 1),
	(459, 2, '20210101', '99991231', 300, 1927, 3, 1),
	(460, 2, '20210101', '99991231', 300, 2461, 4, 1),

	--5-5,5h, 1516, 1818, 2115, 2701
	(461, 2, '20210101', '99991231', 330, 1516, 1, 1),
	(462, 2, '20210101', '99991231', 330, 1818, 2, 1),
	(463, 2, '20210101', '99991231', 330, 2115, 3, 1),
	(464, 2, '20210101', '99991231', 330, 2701, 4, 1),
	
	------------------ Specials ----------------------

	--PriceOverMaxTime,	Court, 134, 168, 195, 253
	(465, 1, '20210101', '99991231', 30, 134, 1, 2),
	(466, 1, '20210101', '99991231', 30, 168, 2, 2),
	(467, 1, '20210101', '99991231', 30, 195, 3, 2),
	(468, 1, '20210101', '99991231', 30, 253, 4, 2),

	--PriceOverMaxTime,	Other, 134, 162, 188, 240
	(469, 2, '20210101', '99991231', 30, 134, 1, 2),
	(470, 2, '20210101', '99991231', 30, 162, 2, 2),
	(471, 2, '20210101', '99991231', 30, 188, 3, 2),
	(472, 2, '20210101', '99991231', 30, 240, 4, 2),

	--InconvenientWorkingHours,	Court, 81, 107, 126, 143
	(473, 1, '20210101', '99991231', 30, 81, 1, 3),
	(474, 1, '20210101', '99991231', 30, 107, 2, 3),
	(475, 1, '20210101', '99991231', 30, 126, 3, 3),
	(476, 1, '20210101', '99991231', 30, 143, 4, 3),

	--InconvenientWorkingHours,	Other, 81, 107, 126, 143
	(477, 2, '20210101', '99991231', 30, 81, 1, 3),
	(478, 2, '20210101', '99991231', 30, 107, 2, 3),
	(479, 2, '20210101', '99991231', 30, 126, 3, 3),
	(480, 2, '20210101', '99991231', 30, 143, 4, 3),

	--WeekendIWH, Court, 134, 168, 195, 253
	(481, 1, '20210101', '99991231', 30, 134, 1, 4),
	(482, 1, '20210101', '99991231', 30, 168, 2, 4),
	(483, 1, '20210101', '99991231', 30, 195, 3, 4),
	(484, 1, '20210101', '99991231', 30, 253, 4, 4),

	--WeekendIWH, Other, 134, 168, 195, 253
	(485, 2, '20210101', '99991231', 30, 134, 1, 4),
	(486, 2, '20210101', '99991231', 30, 168, 2, 4),
	(487, 2, '20210101', '99991231', 30, 195, 3, 4),
	(488, 2, '20210101', '99991231', 30, 253, 4, 4),

	--BigHolidayWeekendIWH, Court, 162, 214, 252, 286
	(489, 1, '20210101', '99991231', 30, 162, 1, 5),
	(490, 1, '20210101', '99991231', 30, 214, 2, 5),
	(491, 1, '20210101', '99991231', 30, 252, 3, 5),
	(492, 1, '20210101', '99991231', 30, 286, 4, 5),

	--BigHolidayWeekendIWH, Other, 162, 214, 252, 286
	(493, 2, '20210101', '99991231', 30, 162, 1, 5),
	(494, 2, '20210101', '99991231', 30, 214, 2, 5),
	(495, 2, '20210101', '99991231', 30, 252, 3, 5),
	(496, 2, '20210101', '99991231', 30, 286, 4, 5),

	--LostTime, Court, 202, 237, 279, 370
	(497, 1, '20210101', '99991231', 60, 202, 1, 6),
	(498, 1, '20210101', '99991231', 60, 237, 2, 6),
	(499, 1, '20210101', '99991231', 60, 279, 3, 6),
	(500, 1, '20210101', '99991231', 60, 370, 4, 6),

	--LostTime, Other, 202, 237, 279, 370
	(501, 2, '20210101', '99991231', 60, 202, 1, 6),
	(502, 2, '20210101', '99991231', 60, 237, 2, 6),
	(503, 2, '20210101', '99991231', 60, 279, 3, 6),
	(504, 2, '20210101', '99991231', 60, 370, 4, 6),

	--LostTime IWH, Court, 81, 107, 126, 143
	(505, 1, '20210101', '99991231', 30, 81, 1, 7),
	(506, 1, '20210101', '99991231', 30, 107, 2, 7),
	(507, 1, '20210101', '99991231', 30, 126, 3, 7),
	(508, 1, '20210101', '99991231', 30, 143, 4, 7),

	--LostTime IWH, Other, 81, 107, 126, 143
	(509, 2, '20210101', '99991231', 30, 81, 1, 7),
	(510, 2, '20210101', '99991231', 30, 107, 2, 7),
	(511, 2, '20210101', '99991231', 30, 126, 3, 7),
	(512, 2, '20210101', '99991231', 30, 143, 4, 7)

SET IDENTITY_INSERT PriceListRows OFF

SELECT * FROM PriceListRows

--kontrollera fÃ¶rmedlingsavgifter, 
SELECT reg.Name, b.Name, plr.CompetenceLevel 
,CONVERT(INT,(ROUND((r.BrokerFee * plr.Price), 0)))
,(r.BrokerFee * plr.Price)
FROM Regions reg 
JOIN Rankings r ON reg.RegionId = r.RegionId
JOIN PriceListRows plr ON 1 = 1
JOIN Brokers b ON r.BrokerId = b.BrokerId
WHERE plr.PriceListRowType = 1 AND plr.EndDate = '99991231' AND plr.PriceListType = 1
AND plr.MaxMinutes = 60
AND r.Rank = 1 AND r.LastValidDate > GETDATE()
ORDER BY reg.Name, plr.CompetenceLevel

SELECT reg.Name, b.Name, plr.CompetenceLevel 
,CONVERT(INT,(ROUND((r.BrokerFee * plr.Price), 0)))
,(r.BrokerFee * plr.Price)
FROM Regions reg 
JOIN Rankings r ON reg.RegionId = r.RegionId
JOIN PriceListRows plr ON 1 = 1
JOIN Brokers b ON r.BrokerId = b.BrokerId
WHERE plr.PriceListRowType = 1 AND plr.EndDate = '99991231' AND plr.PriceListType = 1
AND plr.MaxMinutes = 60
AND r.Rank = 2 AND r.LastValidDate > GETDATE()
ORDER BY reg.Name, plr.CompetenceLevel

SELECT reg.Name, b.Name, plr.CompetenceLevel 
,CONVERT(INT,(ROUND((r.BrokerFee * plr.Price), 0)))
,(r.BrokerFee * plr.Price)
FROM Regions reg 
JOIN Rankings r ON reg.RegionId = r.RegionId
JOIN PriceListRows plr ON 1 = 1
JOIN Brokers b ON r.BrokerId = b.BrokerId
WHERE plr.PriceListRowType = 1 AND plr.EndDate = '99991231' AND plr.PriceListType = 1
AND plr.MaxMinutes = 60
AND r.Rank = 3 AND r.LastValidDate > GETDATE()
ORDER BY reg.Name, plr.CompetenceLevel

ROLLBACK TRAN
