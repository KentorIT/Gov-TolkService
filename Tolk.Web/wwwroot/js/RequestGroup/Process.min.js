$(function(){function n(){e()&&r()&&$("#Accept").attr("disabled",!1)}function o(n,t){$("#Accept").attr("disabled",!0);t.empty();t.append(n);t.show()}function h(){var t,n,i;return!$("#LatestAnswerTimeForCustomer_Date").is(":visible")||$("#LatestAnswerTimeForCustomer_Hour").val()==""||$("#LatestAnswerTimeForCustomer_Minute").val()==""?!0:(t=new Date($("#LatestAnswerTimeForCustomer_Date").val()),t.setHours($("#LatestAnswerTimeForCustomer_Hour").val()),t.setMinutes($("#LatestAnswerTimeForCustomer_Minute").val()),n=$("#LatestAnswerTimeForCustomerValidator"),i=c(t),i.length>0)?(n.empty(),n.append(i),n.show(),!1):(n.empty(),n.hide(),!0)}function c(n){var i=new Date($("#now").val()),t;return i-n==0||i>n?"Angiven sista svarstid har passerats":(t=new Date($("#OccasionList_FirstStartDateTime").val().replace(" ","T").replace(" ","")),t-n==0||t<n)?"Sista svarstid ska vara innan första uppdraget startar":""}var r=function(){var n=!0;return $("input[id$='CanMeetRequirement']:visible").each(function(){var t=$(this).is(":checked"),i=$("#"+$(this).attr("id").replace("CanMeetRequirement","IsRequired")).attr("value")==="True";if(i&&!t)return $("#Accept").attr("disabled",!0),n=!1,!1}),n},e=function(){return $("#InterpreterAnswerModel_InterpreterId").val()!=""&&$("#InterpreterAnswerModel_InterpreterId").val()!=="-1"&&$("#InterpreterAnswerModel_InterpreterId").val()===$("#ExtraInterpreterAnswerModel_InterpreterId").val()&&$("#InterpreterAnswerModel_InterpreterId option:selected").data("additional")!=="Protected"?(o("Det går inte att tillsätta samma tolk, ändra på någon av de tillsatta tolkarna",$("#interpreterIdValidator")),!1):($("#interpreterIdValidator").hide(),!0)},t=function(n){$(n+" select[id$='InterpreterId'] option:selected").val()==="-1"?$(n+" .new-interpreter").collapse("show"):($(n+" .new-interpreter").collapse("hide"),validateInterpreter(n,$(n+" select[id$='InterpreterId']").val(),$(n+" input[id$='NewInterpreterOfficialInterpreterId']").val(),$(n+" select[id$='InterpreterCompetenceLevel']").val(),null,$("#OrderGroupId").val(),$(n+" select[id$='InterpreterId'] option:selected").data("additional")==="Protected"))},s=function(n){$(n+" select[id$='InterpreterId'] option:selected").val()==="-2"?($(n+" .decline-message-panel").collapse("show"),$(n+" .interpreter-information-panel").collapse("hide")):($(n+" .decline-message-panel").collapse("hide"),$(n+" .interpreter-information-panel").collapse("show"))},i,u,f;$(".interpreter-information-panel").on("shown.bs.collapse",function(){n()}).on("hidden.bs.collapse",function(){n()});i=function(){$(".expected-travel-costs-panel, #latestAnswerTimeForCustomer-panel").collapse($("#InterpreterLocation option:selected").val()==="OffSitePhone"||$("#InterpreterLocation option:selected").val()==="OffSiteVideo"||$("#InterpreterLocation option:selected").val()===""?"hide":"show")};$("body").on("click","input[name=SetLatestAnswerTimeForCustomer]",function(){$("#SetLatestAnswerTimeForCustomerValidator").hide();$(this).val()==="Yes"?$("#latestAnswerTimeForCustomer").show():$("#latestAnswerTimeForCustomer").hide()});u=function(){return!$("input[name=SetLatestAnswerTimeForCustomer]").is(":visible")||$("input[name=SetLatestAnswerTimeForCustomer]").filter(":checked").length>0?!0:($("#SetLatestAnswerTimeForCustomerValidator").show(),!1)};f=function(){var n=new Date($("#OccasionList_FirstStartDateTime").val().replace(" ","T").replace(" ",""));$("#LatestAnswerTimeForCustomer_Date").datepicker("setStartDate",new Date($("#now").val()).zeroTime());$("#LatestAnswerTimeForCustomer_Date").datepicker("setEndDate",n.zeroTime())};r();i();t();f();$("#InterpreterAnswerModel_InterpreterCompetenceLevel, #InterpreterAnswerModel_NewInterpreterOfficialInterpreterId").change(function(){validateInterpreter(".interpreter-selection-panel",$("#InterpreterAnswerModel_InterpreterId").val(),$("#InterpreterAnswerModel_NewInterpreterOfficialInterpreterId").val(),$("#InterpreterAnswerModel_InterpreterCompetenceLevel").val(),null,$("#OrderGroupId").val(),$("#InterpreterAnswerModel_InterpreterId option:selected").data("additional")==="Protected")});$("#ExtraInterpreterAnswerModel_InterpreterCompetenceLevel, #ExtraInterpreterAnswerModel_NewInterpreterOfficialInterpreterId").change(function(){validateInterpreter(".extra-interpreter-selection-panel",$("#ExtraInterpreterAnswerModel_InterpreterId").val(),$("#ExtraInterpreterAnswerModel_NewInterpreterOfficialInterpreterId").val(),$("#ExtraInterpreterAnswerModel_InterpreterCompetenceLevel").val(),null,$("#OrderGroupId").val(),$("#ExtraInterpreterAnswerModel_InterpreterId option:selected").data("additional")==="Protected")});$("#InterpreterAnswerModel_InterpreterId").change(function(){n();t(".interpreter-selection-panel")});$("#ExtraInterpreterAnswerModel_InterpreterId").change(function(){n();t(".extra-interpreter-selection-panel");s(".outer-extra-interpreter-panel")});$("#Accept").closest("form").on("submit",function(){if(!u()||!h())return!1;$("#Accept").disableOnSubmit()});$("#InterpreterLocation").change(function(){i()});$(".checkbox").change(function(){n()});$("body").on("click","#cancel-go-back",function(){document.referrer===""||document.referrer.indexOf("Login")>0?window.location.href=tolkBaseUrl+"Home/Index":history.back()})});$(window).on("beforeunload",function(){var n=$("#RequestGroupId").val(),t;n>0&&(t=tolkBaseUrl+"RequestGroup/DeleteView/"+n,$.ajax({type:"DELETE",url:t,data:{__RequestVerificationToken:getAntiForgeryToken()},dataType:"json",async:!1}))});$(document).ready(function(){var n=$("#RequestGroupId").val(),t;n>0&&(t=tolkBaseUrl+"RequestGroup/AddView/"+n,$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:getAntiForgeryToken()},dataType:"json"}))});