function validateControls(){checkWasteTime()&&checkSessionEndedAt()?$("#create").attr("disabled",!1):$("#create").attr("disabled",!0)}function checkWasteTime(){var n=$("#TimeWasteTotalTime").val(),t=$("#TimeWasteIWHTime").val();return n!=""&&isNaN(parseInt(n))||t!=""&&isNaN(parseInt(t))?(triggerValidator("Spilltid måste vara ett tal, ange antal minuter <br ><br >",$("#wasteTimeValidator")),!1):n!=""&&(parseInt(n)<31||parseInt(n)>600)?(triggerValidator("Kontrollera värden för spilltid (ska endast anges om det överstiger 30 min) <br ><br >",$("#wasteTimeValidator")),!1):(n=n==""?0:n,parseInt(t)>parseInt(n)?(triggerValidator("Spilltid för obekväm tid kan inte vara större än den totala spilltiden <br ><br >",$("#wasteTimeValidator")),!1):($("#wasteTimeValidator").hide(),!0))}function checkSessionEndedAt(){var n="#sessionEndedAtValidator";return checkSessionEndedAtBeforeNow()?checkSessionEndedAtAfterStart()?($(n).hide(),!0):(triggerValidator("Faktisk sluttid kan inte ske före faktisk starttid",$(n)),!1):(triggerValidator("Faktisk sluttid kan inte ske efter nutid",$(n)),!1)}function checkSessionEndedAtAfterStart(){var n=new Date($("#SessionEndedAt_Date").val()),t=$("#SessionEndedAt_Hour").val(),r=$("#SessionEndedAt_Minute").val(),u=new Date($("#SessionStartedAt_Date").val()),i,f;if(n!==""&&t!==""&&r!=="")if(i=$("#SessionStartedAt_Hour").val(),f=$("#SessionStartedAt_Minute").val(),n.equalsDate(new Date(u))){if(Number(i)>Number(t))return!1;if(Number(t)===Number(i))return Number(f)<Number(r)}else if(n.before(u))return!1;return!0}function checkSessionEndedAtBeforeNow(){var t=new Date($("#SessionEndedAt_Date").val()),i=$("#SessionEndedAt_Hour").val(),u=$("#SessionEndedAt_Minute").val(),n,r;if(t!==""&&i!==""&&u!=="")if(n=new Date($("#now").val()),t.equalsDate(n)){if(r=n.getHours(),r<Number(i))return!1;if(r===Number(i))return n.getMinutes()>Number(u)}else if(t.after(n))return!1;return!0}function triggerValidator(n,t){t.empty();t.append(n);t.show()}$("#TimeWasteTotalTime").change(function(){validateControls()});$("#TimeWasteIWHTime").change(function(){validateControls()});$("#Outlay").change(function(){validateControls()});$("#CarCompensation").change(function(){validateControls()});$("#PerDiem").change(function(){validateControls()});$("#SessionEndedAt").change(function(){validateControls()});$("#SessionStartedAt").change(function(){validateControls()});$(function(){function t(n){var t=$("#SessionStartedAt_Date").val(),i=$("#SessionEndedAt_Date").val(),u=$("#SessionStartedAt_Hour").val(),f=$("#SessionEndedAt_Hour").val(),r;t!==""&&i===t?(n.find("#MealBreakStartAt_Date").val(t),n.find("#MealBreakEndAt_Date").val(i),n.find("#MealBreakStartAt_Date").attr("disabled",!0),n.find("#MealBreakEndAt_Date").attr("disabled",!0)):(n.find("#MealBreakStartAt_Date").val(t),n.find("#MealBreakEndAt_Date").val(t),n.find("#MealBreakStartAt_Date").attr("disabled",!1),n.find("#MealBreakEndAt_Date").attr("disabled",!1));n.find("#MealBreakStartAt_Hour").val(u).trigger("change");n.find("#MealBreakEndAt_Hour").val(f).trigger("change");r=n.find("form:first");n.bindEnterKey("form:first input",".btn-default");r.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").html("")}var n=0;$("body").on("click",".add-mealbreak-button",function(){var n=$($(this).data("target"));t(n)});$("body").on("click",".remove-mealbreak-row",function(){var i=$(this).closest("tbody"),t;$(this).closest("tr").remove();t=i.find("tr");n=0;t.length===0?$(".mealbreak-list").addClass("d-none"):t.each(function(){$(this).find("input").each(function(){var t=$(this).prop("id").match(/\d+/);$(this).prop("id",$(this).prop("id").replace(t,n));$(this).prop("name",$(this).prop("name").replace(t,n))});n++})});$("body").on("click",".save-mealbreak",function(t){var i,r,u;if(t.preventDefault(),i=$(this).parents(".modal-content"),i.find("form").valid()){r=$("#baseMealBreaks").clone();r.find("input").each(function(){$(this).prop("id",$(this).prop("id").replace("0",n));$(this).prop("name",$(this).prop("name").replace("0",n))});var e=i.find("#MealBreakStartAt_Date").val(),o=i.find("#MealBreakStartAt_Hour").val().length===1?"0"+i.find("#MealBreakStartAt_Hour").val():i.find("#MealBreakStartAt_Hour").val(),s=i.find("#MealBreakStartAt_Minute").val().length===1?"0"+i.find("#MealBreakStartAt_Minute").val():i.find("#MealBreakStartAt_Minute").val(),h=i.find("#MealBreakEndAt_Date").val(),c=i.find("#MealBreakEndAt_Hour").val().length===1?"0"+i.find("#MealBreakEndAt_Hour").val():i.find("#MealBreakEndAt_Hour").val(),l=i.find("#MealBreakEndAt_Minute").val().length===1?"0"+i.find("#MealBreakEndAt_Minute").val():i.find("#MealBreakEndAt_Minute").val(),a=e+" "+o+":"+s,v=h+" "+c+":"+l,f="#MealBreaks_"+n+"__StartAtTemp";r.find(f).val(a);u="#MealBreaks_"+n+"__EndAtTemp";r.find(u).val(v);$(".mealbreak-table > tbody:last-child").append('<tr><td class="table-start-column">'+r.html()+r.find(f).val()+'<\/td><td class="table-end-column">'+r.find(u).val()+'<\/td><td class="table-remove-column"><span class="remove-mealbreak-row bold">&times;<\/span><\/td><\/tr>');n++;$(".mealbreak-list").removeClass("d-none");$("#addMealBreak").modal("hide")}})});