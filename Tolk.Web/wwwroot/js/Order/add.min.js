function AddRequirement(n){n.find("#RequirementDescription").val("");var t=n.find("form:first");n.bindEnterKey("form:first input",".btn-default");t.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").html("")}var LastAnswerByIsShowing=!1;$(function(){var n=0,t=0,i,r,f,e,u,o;$("#travel-time-checkbox").hide();$("body").on("click",".remove-requirement-row",function(){var i=$(this).closest("tbody"),t;$(this).closest("tr").remove();t=i.find("tr");n=0;t.length===0?$(".order-requirement-list").addClass("d-none"):t.each(function(){$(this).find("input").each(function(){var t=$(this).prop("id").match(/\d+/);$(this).prop("id",$(this).prop("id").replace(t,n));$(this).prop("name",$(this).prop("name").replace(t,n))});n++})});$("body").on("click",".remove-desiredRequirement-row",function(){var i=$(this).closest("tbody"),n;$(this).closest("tr").remove();n=i.find("tr");t=0;n.length===0?$(".order-desiredRequirement-list").addClass("d-none"):n.each(function(){$(this).find("input").each(function(){var n=$(this).prop("id").match(/\d+/);$(this).prop("id",$(this).prop("id").replace(n,t));$(this).prop("name",$(this).prop("name").replace(n,t))});t++})});$("body").on("click",".add-requirement-button",function(){var n=$($(this).data("target"));AddRequirement(n);u(n.find("#RequirementType"),n.find("#Gender_rbGroup"),n.find("#RequirementDescription").parents(".form-group"))});$("body").on("click",".add-desiredRequirement-button",function(){var n=$($(this).data("target"));AddRequirement(n);u(n.find("#RequirementType"),n.find("#Gender_rbGroup"),n.find("#RequirementDescription").parents(".form-group"))});$("body").on("click",".save-requirement",function(t){var i,u,r;t.preventDefault();i=$(this).parents(".modal-content");i.find("#RequirementType option:selected").text()==="Tolkens kön"&&(u=i.find("input[type='Radio']").filter(":checked").val()==="Female"?"Kvinna":"Man",i.find("#RequirementDescription").val(u));i.find("form").valid()&&(r=$("#baseRequirement").clone(),r.find("input").each(function(){$(this).prop("id",$(this).prop("id").replace("0",n));$(this).prop("name",$(this).prop("name").replace("0",n))}),n++,i.find("input:not(:checkbox), select, textarea").each(function(){r.find("input[name$='"+$(this).prop("id")+"']").val($(this).val())}),i.find("input:checkbox").each(function(){r.find("input[name$='"+$(this).prop("id")+"']").val($(this).is(":checked")?"true":"false")}),$(".order-requirement-table > tbody:last-child").append('<tr><td class="table-type-column">'+r.html()+$("#RequirementType option:selected").text()+'<\/td><td class="table-description-column">'+$("#RequirementDescription").val()+'<\/td><td class="table-button-column fixed"><span class="remove-requirement-row bold">&times;<\/span><\/td><\/tr>'),$(".order-requirement-list").removeClass("d-none"),$("#addRequirement").modal("hide"))});$("body").on("click",".save-desiredRequirement",function(n){var i,u,r;n.preventDefault();i=$(this).parents(".modal-content");i.find("#RequirementType option:selected").text()==="Tolkens kön"&&(u=i.find("input[type='Radio']").filter(":checked").val()==="Female"?"Kvinna":"Man",i.find("#RequirementDescription").val(u));i.find("form").valid()&&(r=$("#baseDesiredRequirement").clone(),r.find("input").each(function(){$(this).prop("id",$(this).prop("id").replace("0",t));$(this).prop("name",$(this).prop("name").replace("0",t))}),t++,i.find("input:not(:checkbox), select, textarea").each(function(){r.find("input[name$='"+$(this).prop("id")+"']").val($(this).val())}),i.find("input:checkbox").each(function(){r.find("input[name$='"+$(this).prop("id")+"']").val($(this).is(":checked")?"true":"false")}),$(".order-desiredRequirement-table > tbody:last-child").append('<tr><td class="table-type-column">'+r.html()+$(this).parents(".modal-content").find("#RequirementType option:selected").text()+'<\/td><td class="table-description-column">'+$(this).parents(".modal-content").find("#RequirementDescription").val()+'<\/td><td class="table-button-column fixed"><span class="remove-desiredRequirement-row bold">&times;<\/span><\/td><\/tr>'),$(".order-desiredRequirement-list").removeClass("d-none"),$("#addDesiredRequirement").modal("hide"))});i=$("#req").parents(".modal-content");r=$("#des").parents(".modal-content");i.find("#RequirementType").on("change",function(){u(i.find("#RequirementType"),i.find("#Gender_rbGroup"),i.find("#RequirementDescription").parents(".form-group"))});r.find("#RequirementType").on("change",function(){u(r.find("#RequirementType"),r.find("#Gender_rbGroup"),r.find("#RequirementDescription").parents(".form-group"))});$("body").on("change","#LanguageId",function(){e($(this).val())});$("body").on("change","#CompetenceLevelDesireType",function(){var n=$(this).filter("input:checked");$(n[0]).val()==="Requirement"?($("#competence-requested").hide(),$("#competence-required").show()):($("#competence-required").hide(),$("#competence-requested").show())});$("body").on("change","#SplitTimeRange_StartTimeHour",function(){var t=parseInt($(this).val()),i=$("#SplitTimeRange_EndTimeHour").val(),n;i===""&&(n=parseInt($(this).val())===23?0:t+1,$("#SplitTimeRange_EndTimeHour").val(n).trigger("change"))});f=!1;$("body").on("change","#SplitTimeRange_StartDate",function(){var n=new Date($("#now").val()),i,t;f||n.getHours()!==14&&n.getHours()!==0||($("#LastTimeForRequiringLatestAnswerBy").val($("#NextLastTimeForRequiringLatestAnswerBy").val()),f=!0);i=new Date($("#LastTimeForRequiringLatestAnswerBy").val());t=new Date($(this).val());t<=i?($("#LatestAnswerBy").show(),$("#LatestAnswerBy_Date").datepicker("setStartDate",n.zeroTime()),$("#LatestAnswerBy_Date").datepicker("setEndDate",t),LastAnswerByIsShowing=!0):($("#LatestAnswerBy").hide(),LastAnswerByIsShowing=!1)});e=function(n){n===$("#OtherLanguageId").val()?$("#other-language").collapse("show"):$("#other-language").collapse("hide")};u=function(n,t,i){n.val()==="Gender"?(t.show(),i.hide()):(t.hide(),i.show(),i.find("#RequirementDescription").val(""))};$("body").on("change",".location-group",function(){var n=!1;$("select[id^=RankedInterpreterLocation]").each(function(){switch($(this).val()){case"OnSite":case"OffSiteDesignatedLocation":n=!0}});n?$("#travel-time-checkbox").show():($("#AllowMoreThanTwoHoursTravelTime").prop("checked",!1),$("#travel-time-checkbox").hide())});$("body").on("click",".wizard-forward-button",function(){document.body.scrollTop=0;document.documentElement.scrollTop=0});$("body").on("change","#RequiredCompetenceLevels",function(){var n=$('[data-checkbox-group="RequiredCompetenceLevels"]'),t=n.filter(":checked");t.length>=2?n.filter(":not(:checked)").attr("disabled","disabled"):n.filter(":not(:checked)").removeAttr("disabled")});o=function(){var n=new Date($("#now").val());f=!(n.getHours()===13||n.getHours()===23)};$("#CompetenceLevelDesireType").trigger("change");$("#UseRankedInterpreterLocation").trigger("change");o();$("#SplitTimeRange_StartDate").trigger("change")});$(function(){var t=function(){var n,i;if(!$("#LatestAnswerBy_Date").is(":visible"))return!0;var r=new Date($("#LatestAnswerBy_Date").val()),t=$("#LatestAnswerBy_Hour").val(),u=$("#LatestAnswerBy_Minute").val();if(r!==""&&t!==""&&u!==""&&(n=new Date($("#now").val()),r.equalsDate(n))){if(i=n.getHours(),i>Number(t))return!1;if(i===Number(t))return!(n.getMinutes()>Number(u))}return!0},i=function(){if(!$("#LatestAnswerBy_Date").is(":visible"))return!0;var t=new Date($("#LatestAnswerBy_Date").val()),n=$("#LatestAnswerBy_Hour").val(),i=$("#LatestAnswerBy_Minute").val();if(t!==""&&n!==""&&i!==""){var u=new Date($("#SplitTimeRange_StartDate").val()),r=$("#SplitTimeRange_StartTimeHour").val(),f=$("#SplitTimeRange_StartTimeMinutes").val();if(t.equalsDate(new Date(u))){if(Number(n)>Number(r))return!1;if(Number(n)===Number(r))return!(Number(f)>Number(i))}}return!0},r=function(){var r=new Date($("#SplitTimeRange_StartDate").val()),t=$("#SplitTimeRange_StartTimeHour").val(),u=$("#SplitTimeRange_StartTimeMinutes").val(),n,i;if(r!==""&&t!==""&&u!==""&&(n=new Date($("#now").val()),r.equalsDate(n))){if(i=n.getHours(),i>Number(t))return!1;if(i===Number(t))return!(n.getMinutes()>Number(u))}return!0},n=$(".wizard");n.tolkWizard({nextHandler:function(u){var f,e,o;if(LastAnswerByIsShowing||($("#LatestAnswerBy_Date").val(""),$("#LatestAnswerBy_Hour").select2("val",""),$("#LatestAnswerBy_Minute").select2("val","")),!r())return alert("Uppdraget har en starttid som redan har passerats, var god ändra detta."),!1;if(!t())return alert("Sista svarstid har redan passerats, var god ändra detta."),!1;if(!i())return alert("Sista svarstid kan inte vara senare än tolkuppdragets starttid, var god ändra detta."),!1;f=n.closest("form");e=u.NextStep;u.IsLastPage?($("#send").attr("disabled","disabled"),f.submit()):(o=tolkBaseUrl+"Order/Confirm",$.ajax({url:o,type:"POST",data:f.serialize(),dataType:"html",success:function(n){$(".wizard .wizard-step").eq(e).html(n)},error:function(n){alert(n)}}))},wizardStepRendered:function(){$("#send").append('<span class="center-glyphicon glyphicon glyphicon-triangle-right"><\/span>');$("#send").blur()}})});