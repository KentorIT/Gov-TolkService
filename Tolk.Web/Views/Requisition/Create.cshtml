@model Tolk.Web.Models.RequisitionModel
@using Tolk.Web.Services
@using Tolk.BusinessLogic.Enums
@{
    ViewData["Title"] = "Skapa rekvisition";
}
<div class="row">
    <div class="col-md-8">
        <h2>@ViewData["Title"]</h2>
        <display-entry asp-for="OrderNumber" />
        <display-entry asp-for="BrokerName" />
        <display-entry asp-for="OrderCreatedBy" />
        <display-entry asp-for="RegionName" />
        <display-entry asp-for="CustomerReferenceNumber" />
        <display-entry asp-for="LanguageName" />
        <display-entry asp-for="InterpreterName" />
        @if (Model.PreviousRequisition != null)
        {
            <a href="@Url.Action("View", "Requisition", new { id = Model.PreviousRequisition.RequisitionId })">Se tidigare rekvisition</a>
        }
        <form method="post">
            <input asp-for="RequestId" type="hidden" />
            <input asp-for="CombinedMaxSizeAttachments" type="hidden" />
            <input asp-for="FileGroupKey" type="hidden" />
            <form-entry asp-for="InterpreterTaxCard" type="select" asp-items="SelectListService.TaxCards" class="allow-clear" />
            @if (Model.PreviousRequisition != null)
            {
                <display-entry asp-for="PreviousRequisition.TimeWasteInfo" label-override="Tidigare angiven tidsspillan" />
            }
            <form-entry asp-for="TimeWasteTotalTime" />
            <form-entry asp-for="TimeWasteIWHTime" />
            <div id="wasteTimeValidator" class="d-none text-danger body"></div>
            <display-entry asp-for="ExpectedStartedAt" />
            @if (Model.PreviousRequisition != null)
            {
                <display-entry asp-for="PreviousRequisition.SessionStartedAt" />
            }
            <form-entry asp-for="SessionStartedAt" />
            <display-entry asp-for="ExpectedEndedAt" />
            @if (Model.PreviousRequisition != null)
            {
                <display-entry asp-for="PreviousRequisition.SessionEndedAt" />
            }
            <form-entry asp-for="SessionEndedAt" />
            <display-entry asp-for="ExpectedTravelCosts" />
            @if (Model.PreviousRequisition?.TravelCosts != null)
            {
                <display-entry asp-for="PreviousRequisition.TravelCosts" />
            }
            <form-entry asp-for="TravelCosts" />
            <div id="travelCostsValidator" class="d-none text-danger body"></div>
            <form-entry asp-for="Message" />
            @await Html.PartialAsync("_FileList", new AttachmentListModel { AllowDelete = true, AllowDownload = true, AllowUpload = true, Files = Model.Files, Description = "Möjlighet att bifoga filer som kan vara relevanta för rekvisitionen", Title = string.Empty })
            <br />
            <br />
            <button id="create" type="submit" class="btn btn-default">Skapa</button>
            <a class="btn btn-warning pull-right do-not-check-dirty" asp-controller="Assignment" asp-action="List" asp-route-Status="ToBeReported">Avbryt</a>
        </form>
        <span id="basefile" class="d-none">
            <input asp-for="Files[0].Id" type="hidden" />
        </span>
    </div>
</div>
@Html.Partial("_UploadFileDialog")

@section Scripts {
    <environment include="Development">
        <script src="~/js/Files.js" asp-append-version="true"></script>
        <script src="~/js/Requisition/Create.js" asp-append-version="true"></script>
    </environment>
    <environment exclude="Development">
        <script src="~/js/Files.min.js" asp-append-version="true"></script>
        <script src="~/js/Requisition/Create.min.js" asp-append-version="true"></script>
    </environment>
    @await Html.PartialAsync("_ValidationScriptsPartial")
}
