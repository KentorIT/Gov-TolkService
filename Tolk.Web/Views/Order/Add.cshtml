@model Tolk.Web.Models.OrderModel
@inject SelectListService SelectListService
@using Tolk.Web.Services
@using Tolk.BusinessLogic.Helpers
@using Tolk.BusinessLogic.Utilities
@{
    ViewData["Title"] = "Avropa tolk";
}

<div class="row">
    <div class="col-xs-12">
        <h2>Bokningsuppgifter</h2>
        <hr />
        <form method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" asp-for="SystemTime" />
            <form-entry asp-for="AssignmentType" type="radio-group" asp-items="SelectListService.AssignmentTypes" />
            <div class="row">
                <div class="col-sm-4">
                    <form-entry asp-for="LanguageId" class="collapse in" id="language-panel" type="select" asp-items="SelectListService.Languages" />
                    <input id="OtherLanguageId" type="hidden" value="@OrderModel.OtherLanguageId" />
                    <form-entry asp-for="OtherLanguage" class="collapse" id="other-language" />
                </div>
                <div class="col-sm-4">
                    <form-entry asp-for="Dialect" />
                </div>
                <div class="col-sm-4">
                    <form-entry asp-for="RegionId" type="select" asp-items="SelectListService.Regions" />
                </div>
            </div>
            <form-entry asp-for="SplitTimeRange" class="order-datepicker" />
            <div class="row">
                <div class="col-sm-8">
                    <form-entry asp-for="LatestAnswerBy" id="LatestAnswerBy" />
                </div>
            </div>
            <div class="row ranked-InterpreterLocation">
                <div class="col-sm-4 location-group">
                    <form-entry asp-for="RankedInterpreterLocationFirst" type="select" asp-items="SelectListService.InterpreterLocations" class="allow-clear interpreter-group" />
                    <div class="address-RankedInterpreterLocationFirst grouped-form-boxes">
                        <div class="address-information">
                            <form-entry asp-for="RankedInterpreterLocationFirstAddressModel.LocationStreet" />
                            <form-entry asp-for="RankedInterpreterLocationFirstAddressModel.LocationZipCode" />
                            <form-entry asp-for="RankedInterpreterLocationFirstAddressModel.LocationCity" />
                        </div>
                        <div class="off-site-information">
                            <form-entry asp-for="RankedInterpreterLocationFirstAddressModel.OffSiteContactInformation" />
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 interpreter-location-second location-group bg-gray">
                    <form-entry asp-for="RankedInterpreterLocationSecond" type="select" asp-items="SelectListService.InterpreterLocations" class="allow-clear interpreter-group" />
                    <div class="address-RankedInterpreterLocationSecond">
                        <div class="address-information">
                            <form-entry asp-for="RankedInterpreterLocationSecondAddressModel.LocationStreet" />
                            <form-entry asp-for="RankedInterpreterLocationSecondAddressModel.LocationZipCode" />
                            <form-entry asp-for="RankedInterpreterLocationSecondAddressModel.LocationCity" />
                        </div>
                        <div class="off-site-information">
                            <form-entry asp-for="RankedInterpreterLocationSecondAddressModel.OffSiteContactInformation" />
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 interpreter-location-third location-group">
                    <form-entry asp-for="RankedInterpreterLocationThird" type="select" asp-items="SelectListService.InterpreterLocations" class="allow-clear interpreter-group" />
                    <div class="address-RankedInterpreterLocationThird">
                        <div class="address-information">
                            <form-entry asp-for="RankedInterpreterLocationThirdAddressModel.LocationStreet" />
                            <form-entry asp-for="RankedInterpreterLocationThirdAddressModel.LocationZipCode" />
                            <form-entry asp-for="RankedInterpreterLocationThirdAddressModel.LocationCity" />
                        </div>
                        <div class="off-site-information">
                            <form-entry asp-for="RankedInterpreterLocationThirdAddressModel.OffSiteContactInformation" />
                        </div>
                    </div>
                </div>
                <div id="interpreterLocationValidator" class="d-none text-danger body"></div>
            </div>
            <form-entry asp-for="AllowMoreThanTwoHoursTravelTime" />
            <div class="row">
                <div class="col-sm-12">
                    <span class="col-sm-6">
                        <span class="header-with-line">Kompetensnivå</span>
                        <p class="important-info">I de fall inget krav eller önskemål om kompetensnivå har angetts ska förmedlingen tillsätta tolk med högsta möjliga kompetens enligt principen för kompetensprioritering i ramavtalet.</p>
                        <form-entry asp-for="SpecificCompetenceLevelRequired" />
                        <span id="competence-required">
                            <form-entry asp-for="RequiredCompetenceLevelFirst" type="select" asp-items="SelectListService.CompetenceLevels" class="allow-clear competence-level" />
                            <form-entry asp-for="RequiredCompetenceLevelSecond" type="select" asp-items="SelectListService.CompetenceLevels" class="allow-clear competence-level" />
                        </span>
                        <span id="competence-requested">
                            <form-entry asp-for="RequestedCompetenceLevelFirst" type="select" asp-items="SelectListService.CompetenceLevels" class="allow-clear competence-level" />
                            <form-entry asp-for="RequestedCompetenceLevelSecond" type="select" asp-items="SelectListService.CompetenceLevels" class="allow-clear competence-level" />
                            <form-entry asp-for="RequestedCompetenceLevelThird" type="select" asp-items="SelectListService.CompetenceLevels" class="allow-clear competence-level" />
                        </span>
                    </span>
                </div>
            </div>
            <form-entry asp-for="Description" />
            @await Html.PartialAsync("_FileList", new AttachmentListModel { AllowDelete = true, AllowDownload = true, AllowUpload = true, Files = Model.Files, Description = "Möjlighet att bifoga filer som kan vara relevanta vid tillsättning av tolk", Title = string.Empty })
            <fieldset>
                <br /><br />
                <legend>Övriga önskemål/krav <a href="#" class="edit-link add-requirement-button font-size-14" data-toggle="modal" data-backdrop="static" data-target="#addRequirement">Lägg till behov</a></legend>
                <div class="d-none order-requirement-list border no-padding">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover order-requirement-table">
                            <thead>
                                <tr>
                                    <th>Typ</th>
                                    <th>Beskrivning</th>
                                    <th>Är krav</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </fieldset>
            <h2>Myndighetens uppgifter</h2>
            <hr />
            <div class="row">
                <div class="col-sm-4">
                    <display-entry asp-for="UserInfo" />
                </div>
                <div class="col-sm-8">
                    <div class="row">
                        <div class="col-sm-6">
                            <form-entry asp-for="CustomerReferenceNumber" />
                        </div>
                        <div class="col-sm-6">
                            <form-entry asp-for="UnitName" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <form-entry asp-for="ContactPersonId" type="select" asp-items="SelectListService.OtherContactPersons" class="allow-clear" />
                        </div>
                    </div>
                </div>
            </div>
            <a class="btn btn-large btn-warning pull-left do-not-check-dirty" asp-controller="Home" asp-action="Index">Avbryt <span class="glyphicon glyphicon-remove"></span></a>
            <button class="btn btn-large pull-right btn-default" id="send">Gå vidare <span class="glyphicon glyphicon-triangle-right"></span></button>
        </form>
        <span id="basefile" class="d-none">
            <input asp-for="Files[0].Id" type="hidden" />
        </span>
        <span id="baseRequirement" class="d-none">
            <input asp-for="OrderRequirements[0].OrderRequirementId" type="hidden" />
            <input asp-for="OrderRequirements[0].RequirementType" type="hidden" />
            <input asp-for="OrderRequirements[0].RequirementIsRequired" type="hidden" />
            <input asp-for="OrderRequirements[0].RequirementDescription" type="hidden" />
        </span>
    </div>
</div>
@Html.Partial("_UploadFileDialog")
<div id="addRequirement" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Lägg till behov</h4>
            </div>
            <div class="modal-body">
                @Html.Partial("_Requirement", new OrderRequirementModel())
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-warning pull-left do-not-check-dirty" data-dismiss="modal">Avbryt</button>
                <button type="button" class="btn btn-default pull-right save-requirement">Skicka</button>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <environment include="Development">
        <script src="~/js/Files.js" asp-append-version="true"></script>
        <script src="~/js/Order/Add.js" asp-append-version="true"></script>
        <script src="~/js/Order/HandleInterpreterLocations.js" asp-append-version="true"></script>
    </environment>
    <environment exclude="Development">
        <script src="~/js/Files.min.js" asp-append-version="true"></script>
        <script src="~/js/Order/add.min.js" asp-append-version="true"></script>
        <script src="~/js/Order/HandleInterpreterLocations.min.js" asp-append-version="true"></script>
    </environment>
    @await Html.PartialAsync("_ValidationScriptsPartial")
}
